<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Furkan's Work Portal</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Syne:wght@400;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #080808;
      --surface: #111;
      --surface2: #161616;
      --border: rgba(255,255,255,0.07);
      --red: #e63946;
      --amber: #f4a261;
      --green: #2a9d5c;
      --white: #f0f0f0;
      --muted: #555;
      --mono: 'Space Mono', monospace;
      --display: 'Bebas Neue', sans-serif;
      --body: 'Syne', sans-serif;
    }

    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--white);
      font-family: var(--body);
      min-height: 100vh;
      overflow-x: hidden;
    }
    body::after {
      content: '';
      position: fixed; inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 9998;
    }

    /* ‚ïê‚ïê STICKY PROGRESS ‚ïê‚ïê */
    .prog-bar {
      position: fixed; top: 0; left: 0; right: 0; z-index: 9000;
      background: rgba(8,8,8,0.96); backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 10px 24px;
      display: flex; align-items: center; gap: 14px;
    }
    .prog-label {
      font-family: var(--mono); font-size: 0.58rem;
      letter-spacing: 0.2em; text-transform: uppercase;
      color: var(--muted); white-space: nowrap;
    }
    .prog-track {
      flex: 1; height: 2px;
      background: rgba(255,255,255,0.06); overflow: hidden;
    }
    .prog-fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--red), var(--amber));
      transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
    }
    .prog-fill.done { background: linear-gradient(90deg, var(--green), #4ade80); }
    .prog-steps {
      display: flex; gap: 5px; align-items: center;
    }
    .prog-step {
      width: 6px; height: 6px; border-radius: 50%;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.35s;
    }
    .prog-step.done-step {
      background: var(--green);
      border-color: var(--green);
      box-shadow: 0 0 6px rgba(42,157,92,0.5);
    }
    .prog-step.active-step {
      background: var(--amber);
      border-color: var(--amber);
      box-shadow: 0 0 6px rgba(244,162,97,0.5);
    }

    /* ‚ïê‚ïê WORK SECTION ‚ïê‚ïê */
    .work-section {
      min-height: 100vh;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 100px 24px 80px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid var(--border);
    }
    .work-section::before {
      content: '';
      position: absolute; inset: 0;
      background: radial-gradient(ellipse 55% 45% at 50% 55%, rgba(230,57,70,0.05) 0%, transparent 70%);
      pointer-events: none;
    }
    .eyebrow {
      font-family: var(--mono); font-size: 0.62rem;
      letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--red); margin-bottom: 20px;
      display: flex; align-items: center; gap: 12px;
    }
    .eyebrow::before, .eyebrow::after {
      content: ''; width: 28px; height: 1px;
      background: var(--red); opacity: 0.4;
    }
    .work-section h1 {
      font-family: var(--display);
      font-size: clamp(52px, 12vw, 118px);
      line-height: 0.91; letter-spacing: 0.02em; margin-bottom: 22px;
    }
    .work-section h1 em { display: block; color: var(--red); font-style: normal; }
    .work-desc {
      max-width: 460px; font-size: 0.93rem;
      color: var(--muted); line-height: 1.75;
      margin-bottom: 40px;
    }
    .sheet-btn {
      display: inline-flex; align-items: center; gap: 14px;
      background: var(--white); color: var(--bg);
      text-decoration: none; font-family: var(--mono);
      font-size: 0.73rem; font-weight: 700;
      letter-spacing: 0.15em; text-transform: uppercase;
      padding: 16px 32px;
      transition: transform 0.2s, box-shadow 0.2s, color 0.2s;
      position: relative; overflow: hidden;
    }
    .sheet-btn::before {
      content: ''; position: absolute; inset: 0;
      background: var(--red); transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    .sheet-btn:hover::before { transform: translateX(0); }
    .sheet-btn:hover { color: var(--white); transform: translateY(-3px); box-shadow: 0 12px 30px rgba(0,0,0,0.5); }
    .sheet-btn span, .sheet-btn .arr { position: relative; z-index: 1; }
    .sheet-btn .arr { transition: transform 0.2s; }
    .sheet-btn:hover .arr { transform: translateX(4px); }

    .scroll-hint {
      position: absolute; bottom: 28px; left: 50%; transform: translateX(-50%);
      display: flex; flex-direction: column; align-items: center; gap: 8px;
      text-decoration: none; opacity: 0.35; transition: opacity 0.2s;
      animation: fadeUp 1s ease 1.8s both;
    }
    .scroll-hint:hover { opacity: 0.8; }
    .scroll-hint-txt {
      font-family: var(--mono); font-size: 0.56rem;
      letter-spacing: 0.25em; text-transform: uppercase; color: var(--white);
    }
    .scroll-line {
      width: 1px; height: 36px;
      background: linear-gradient(to bottom, var(--white), transparent);
      animation: pulse-line 2s ease-in-out infinite;
    }
    @keyframes pulse-line {
      0%,100% { opacity: 0.5; transform: scaleY(1); }
      50%      { opacity: 0.15; transform: scaleY(0.6); }
    }

    /* ‚ïê‚ïê GATE SECTION ‚ïê‚ïê */
    .gate-section { max-width: 720px; margin: 0 auto; padding: 80px 24px 120px; }

    .gate-header { text-align: center; margin-bottom: 56px; }
    .gate-header .eyebrow { justify-content: center; }
    .gate-header h2 {
      font-family: var(--display); font-size: clamp(34px, 7vw, 68px);
      letter-spacing: 0.03em; line-height: 0.94; margin-bottom: 14px;
    }
    .gate-header h2 span { color: var(--red); }
    .gate-header p { font-size: 0.87rem; color: var(--muted); max-width: 400px; margin: 0 auto; line-height: 1.65; }

    /* ‚ïê‚ïê STEP CARDS ‚ïê‚ïê */
    .steps { display: flex; flex-direction: column; gap: 3px; }

    /* regular acknowledge cards */
    .step-card {
      background: var(--surface); border: 1px solid var(--border);
      cursor: pointer; position: relative; overflow: hidden;
      transition: background 0.25s, border-color 0.25s;
      user-select: none;
    }
    .step-card::before {
      content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
      background: var(--red); transform: scaleY(0); transform-origin: bottom;
      transition: transform 0.35s ease;
    }
    .step-card.done { background: #0d1a12; border-color: rgba(42,157,92,0.22); }
    .step-card.done::before { background: var(--green); transform: scaleY(1); }

    .step-inner {
      padding: 22px 24px;
      display: grid; grid-template-columns: 48px 1fr 28px;
      align-items: center; gap: 18px;
    }
    .step-icon {
      width: 48px; height: 48px; flex-shrink: 0;
      background: var(--surface2); border: 1px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 1.25rem;
      transition: background 0.25s, border-color 0.25s;
    }
    .step-card.done .step-icon { background: rgba(42,157,92,0.08); border-color: rgba(42,157,92,0.28); }

    .step-num {
      font-family: var(--mono); font-size: 0.55rem;
      letter-spacing: 0.2em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 5px;
      transition: color 0.25s;
    }
    .step-card.done .step-num { color: rgba(74,222,128,0.45); }

    .step-title {
      font-family: var(--display); font-size: 1.3rem;
      letter-spacing: 0.05em; color: var(--white);
      margin-bottom: 4px; line-height: 1; transition: color 0.25s;
    }
    .step-card.done .step-title { color: #4ade80; }

    .step-desc { font-size: 0.78rem; color: var(--muted); line-height: 1.55; transition: color 0.25s; }
    .step-card.done .step-desc { color: rgba(74,222,128,0.4); }

    .step-check {
      width: 28px; height: 28px; border-radius: 50%;
      border: 1.5px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 0.8rem; color: transparent;
      transition: all 0.3s;
    }
    .step-card.done .step-check {
      border-color: var(--green); background: var(--green); color: #fff;
      box-shadow: 0 0 10px rgba(42,157,92,0.35);
    }

    .step-card .ripple {
      position: absolute; border-radius: 50%;
      background: rgba(42,157,92,0.12);
      transform: scale(0);
      animation: rpl 0.55s linear;
      pointer-events: none;
    }
    @keyframes rpl { to { transform: scale(4); opacity: 0; } }

    /* ‚ïê‚ïê EMERGENCY FINAL CARD ‚ïê‚ïê */
    .emergency-card {
      background: var(--surface);
      border: 1px solid var(--border);
      position: relative; overflow: hidden;
      transition: border-color 0.4s, background 0.4s;
      opacity: 0.35;
      pointer-events: none;
      transition: opacity 0.4s, border-color 0.4s, background 0.4s;
    }
    .emergency-card.unlocked {
      opacity: 1; pointer-events: all;
      border-color: rgba(230,57,70,0.3);
      background: #180a0b;
      animation: pulse-border 2.5s ease-in-out infinite;
    }
    @keyframes pulse-border {
      0%,100% { border-color: rgba(230,57,70,0.3); }
      50%      { border-color: rgba(230,57,70,0.6); }
    }
    .emergency-card::before {
      content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
      background: var(--red);
    }

    .emg-inner { padding: 28px 24px; }

    .emg-tag {
      font-family: var(--mono); font-size: 0.58rem;
      letter-spacing: 0.25em; text-transform: uppercase;
      color: var(--red); margin-bottom: 12px;
      display: flex; align-items: center; gap: 8px;
    }
    .emg-tag::after {
      content: ''; flex: 1; height: 1px;
      background: rgba(230,57,70,0.2);
    }
    .emg-heading {
      font-family: var(--display);
      font-size: clamp(1.6rem, 4vw, 2.4rem);
      letter-spacing: 0.04em; line-height: 1;
      margin-bottom: 10px; color: var(--white);
    }
    .emg-heading span { color: var(--red); }
    .emg-desc {
      font-size: 0.82rem; color: var(--muted); line-height: 1.65;
      margin-bottom: 28px; max-width: 500px;
    }
    .emg-desc strong { color: rgba(255,255,255,0.7); }

    .emg-btns { display: flex; gap: 10px; flex-wrap: wrap; }

    .btn-yes {
      display: inline-flex; align-items: center; gap: 10px;
      background: var(--red); color: #fff;
      font-family: var(--mono); font-size: 0.7rem;
      font-weight: 700; letter-spacing: 0.14em; text-transform: uppercase;
      padding: 13px 24px; border: none; cursor: pointer;
      transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
    }
    .btn-yes:hover { background: #c1121f; transform: translateY(-2px); box-shadow: 0 8px 20px rgba(230,57,70,0.35); }

    .btn-no {
      display: inline-flex; align-items: center; gap: 10px;
      background: transparent; color: var(--muted);
      font-family: var(--mono); font-size: 0.7rem;
      font-weight: 700; letter-spacing: 0.14em; text-transform: uppercase;
      padding: 13px 24px;
      border: 1px solid rgba(255,255,255,0.08); cursor: pointer;
      transition: all 0.2s;
    }
    .btn-no:hover { border-color: rgba(255,255,255,0.2); color: var(--white); transform: translateY(-2px); }

    /* locked hint below emergency card */
    .locked-hint {
      text-align: center; padding: 14px 0 0;
      font-family: var(--mono); font-size: 0.58rem;
      letter-spacing: 0.2em; text-transform: uppercase;
      color: #333; transition: opacity 0.4s;
    }
    .locked-hint.hidden { opacity: 0; pointer-events: none; }

    /* ‚ïê‚ïê MAIL MODAL ‚ïê‚ïê */
    .modal-bg {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.9); backdrop-filter: blur(8px);
      z-index: 10000;
      display: flex; align-items: center; justify-content: center; padding: 20px;
      opacity: 0; pointer-events: none; transition: opacity 0.3s;
    }
    .modal-bg.open { opacity: 1; pointer-events: all; }
    .modal-box {
      background: #0e0e0e; border: 1px solid rgba(255,255,255,0.1);
      max-width: 490px; width: 100%; padding: 38px;
      position: relative;
      transform: translateY(18px) scale(0.97);
      transition: transform 0.3s ease;
    }
    .modal-bg.open .modal-box { transform: none; }
    .modal-x {
      position: absolute; top: 14px; right: 16px;
      background: none; border: none; color: var(--muted);
      font-size: 1.25rem; cursor: pointer; transition: color 0.2s;
    }
    .modal-x:hover { color: var(--white); }
    .modal-tag {
      font-family: var(--mono); font-size: 0.6rem;
      color: var(--green); letter-spacing: 0.22em;
      text-transform: uppercase; margin-bottom: 12px;
    }
    .modal-title {
      font-family: var(--display); font-size: 2rem;
      letter-spacing: 0.04em; line-height: 1.05; margin-bottom: 8px;
    }
    .modal-to {
      font-size: 0.8rem; color: var(--muted); margin-bottom: 26px; line-height: 1.6;
    }
    .modal-to strong { color: var(--white); }
    .form { display: flex; flex-direction: column; gap: 11px; }
    .field { display: flex; flex-direction: column; gap: 5px; }
    .field label {
      font-family: var(--mono); font-size: 0.56rem;
      letter-spacing: 0.2em; text-transform: uppercase; color: #444;
    }
    .field input, .field textarea {
      background: #161616; border: 1px solid rgba(255,255,255,0.07);
      color: var(--white); font-family: var(--body); font-size: 0.87rem;
      padding: 11px 13px; outline: none; resize: none; transition: border-color 0.2s;
    }
    .field input:focus, .field textarea:focus { border-color: rgba(42,157,92,0.45); }
    .field input::placeholder, .field textarea::placeholder { color: #2e2e2e; }
    .btn-send {
      background: var(--green); color: #fff; border: none;
      font-family: var(--mono); font-size: 0.7rem; letter-spacing: 0.14em;
      text-transform: uppercase; padding: 13px;
      cursor: pointer; font-weight: 700; margin-top: 3px;
      transition: background 0.2s, transform 0.15s;
      display: flex; align-items: center; justify-content: center; gap: 8px;
      text-decoration: none;
    }
    .btn-send:hover { background: #1d7a45; transform: translateY(-1px); }

    /* ‚ïê‚ïê GOODBYE ‚ïê‚ïê */
    .bye-overlay {
      position: fixed; inset: 0; background: var(--bg); z-index: 20000;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center; gap: 18px;
      opacity: 0; pointer-events: none; transition: opacity 0.5s;
    }
    .bye-overlay.open { opacity: 1; pointer-events: all; }
    .bye-emoji { font-size: 3.2rem; animation: wave 0.8s ease 3; }
    @keyframes wave { 0%,100%{transform:rotate(0)} 30%{transform:rotate(25deg)} 70%{transform:rotate(-10deg)} }
    .bye-title {
      font-family: var(--display);
      font-size: clamp(55px, 13vw, 120px);
      letter-spacing: 0.04em; line-height: 0.9; text-align: center;
    }
    .bye-title span { color: var(--red); }
    .bye-sub {
      font-family: var(--mono); font-size: 0.66rem;
      color: var(--muted); letter-spacing: 0.2em;
      text-transform: uppercase; text-align: center;
    }
    .bye-note {
      font-family: var(--mono); font-size: 0.56rem;
      color: #2a2a2a; letter-spacing: 0.15em; margin-top: 8px; text-align: center;
    }

    /* ‚ïê‚ïê UTILS ‚ïê‚ïê */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(18px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .fi { animation: fadeUp 0.7s ease both; }
    .d1{animation-delay:.1s} .d2{animation-delay:.25s} .d3{animation-delay:.4s} .d4{animation-delay:.55s}

    @media (max-width: 540px) {
      .step-inner { grid-template-columns: 40px 1fr 26px; gap: 13px; padding: 18px 16px; }
      .step-icon { width: 40px; height: 40px; font-size: 1.1rem; }
      .emg-inner { padding: 22px 18px; }
      .modal-box { padding: 26px 18px; }
    }
  </style>
</head>
<body>

  <!-- ‚ïê‚ïê PROGRESS BAR ‚ïê‚ïê -->
  <div class="prog-bar">
    <div class="prog-label">Progress</div>
    <div class="prog-track"><div class="prog-fill" id="progFill"></div></div>
    <div class="prog-steps">
      <div class="prog-step" id="ps0"></div>
      <div class="prog-step" id="ps1"></div>
      <div class="prog-step" id="ps2"></div>
    </div>
  </div>

  <!-- ‚ïê‚ïê SECTION 1 ‚Äî WORK SHEET ‚ïê‚ïê -->
  <section class="work-section">
    <div class="eyebrow fi d1">Start Here</div>
    <h1 class="fi d2">Check Work<br/><em>Status First</em></h1>
    <p class="work-desc fi d3">Before doing anything else ‚Äî open the sheet. Your task, update, or new assignment is probably already there. Save us both the time.</p>
    <a class="sheet-btn fi d4"
       href="https://docs.google.com/spreadsheets/d/1bG37fEyl8ZJ1K5T2ghOAq3AUSI3CHhTOXVPMopnI-M4/edit?usp=sharing"
       target="_blank" rel="noopener noreferrer">
      <span>Open Work Sheet</span>
      <span class="arr">‚Üí</span>
    </a>
    <a class="scroll-hint" href="#gate">
      <div class="scroll-line"></div>
    </a>
  </section>

  <!-- ‚ïê‚ïê SECTION 2 ‚Äî GATE ‚ïê‚ïê -->
  <section class="gate-section" id="gate">

    <div class="gate-header">
      <div class="eyebrow">Before You Contact Me</div>
      <h2>Read Every<br/><span>Rule First</span></h2>
      <p>Click each card to acknowledge it. The emergency gate opens only after all three are confirmed.</p>
    </div>

    <div class="steps">

      <!-- RULE 1 -->
      <div class="step-card" data-id="0" onclick="acknowledge(this,event)">
        <div class="step-inner">
          <div class="step-icon">üåô</div>
          <div>
            <div class="step-num">Rule 01 ¬∑ Click to confirm</div>
            <div class="step-title">No Calls After 7 PM</div>
            <div class="step-desc">After 7:00 PM is personal time ‚Äî it is completely off limits. I will not pick up. Don't even try unless something is actively burning.</div>
          </div>
          <div class="step-check">‚úì</div>
        </div>
      </div>

      <!-- RULE 2 -->
      <div class="step-card" data-id="1" onclick="acknowledge(this,event)">
        <div class="step-inner">
          <div class="step-icon">‚è±Ô∏è</div>
          <div>
            <div class="step-num">Rule 02 ¬∑ Click to confirm</div>
            <div class="step-title">Discussions End Before 7 PM</div>
            <div class="step-desc">All work conversations, decisions, and follow-ups must be wrapped up before 7:00 PM. Plan ahead ‚Äî last minute is your problem, not mine.</div>
          </div>
          <div class="step-check">‚úì</div>
        </div>
      </div>

      <!-- RULE 3 -->
      <div class="step-card" data-id="2" onclick="acknowledge(this,event)">
        <div class="step-inner">
          <div class="step-icon">üèñÔ∏è</div>
          <div>
            <div class="step-num">Rule 03 ¬∑ Click to confirm</div>
            <div class="step-title">On Leave = Do Not Disturb</div>
            <div class="step-desc">If I'm on leave, I'm unavailable. No calls, no messages. Leave exists for a reason. Respect it unless no one else on the planet can help.</div>
          </div>
          <div class="step-check">‚úì</div>
        </div>
      </div>

      <!-- SPACER -->
      <div style="height: 3px; background: rgba(230,57,70,0.08);"></div>

      <!-- RULE 4: EMERGENCY GATE (no acknowledge ‚Äî direct yes/no) -->
      <div class="emergency-card" id="emergencyCard">
        <div class="emg-inner">
          <div class="emg-tag">üö® Final Check ¬∑ Unlocks after rules 01‚Äì03</div>
          <div class="emg-heading">Is This a<br/><span>Real Emergency?</span></div>
          <p class="emg-desc">
            Be <strong>brutally honest</strong> with yourself right now.<br/>
            Can it wait until tomorrow? Can someone else handle it?<br/>
            Is there truly no other option?
          </p>
          <div class="emg-btns">
            <button class="btn-yes" onclick="openMail()">‚úÖ Yes ‚Äî It Cannot Wait</button>
            <button class="btn-no"  onclick="openBye()">üëã No ‚Äî Never Mind</button>
          </div>
        </div>
      </div>

      <div class="locked-hint" id="lockedHint">
        ‚Üë acknowledge all 3 rules above to unlock this
      </div>

    </div><!-- /steps -->
  </section>

  <!-- ‚ïê‚ïê MAIL MODAL ‚ïê‚ïê -->
  <div class="modal-bg" id="mailModal">
    <div class="modal-box">
      <button class="modal-x" onclick="closeMail()">‚úï</button>
      <div class="modal-tag">üö® Urgent ¬∑ Verified Emergency</div>
      <div class="modal-title">Send Me<br/>a Message</div>
      <p class="modal-to">Sending to <strong>furkan.khan@timesinternet.in</strong><br/>You cleared all the gates. Make it worth it.</p>
      <div class="form">
        <div class="field">
          <label>Your Name</label>
          <input type="text" id="sName" placeholder="Who is this?"/>
        </div>
        <div class="field">
          <label>Subject</label>
          <input type="text" id="sSubject" placeholder="What's the emergency?"/>
        </div>
        <div class="field">
          <label>Message</label>
          <textarea id="sBody" rows="5" placeholder="Be specific. What do you need and why can't it wait?"></textarea>
        </div>
        <a class="btn-send" href="#" onclick="doSend(event)">Send Email ‚Üí</a>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê GOODBYE ‚ïê‚ïê -->
  <div class="bye-overlay" id="byeOverlay">
    <div class="bye-emoji">üëã</div>
    <div class="bye-title">See You<br/><span>Tomorrow</span></div>
    <div class="bye-sub">Good call. Catch you during working hours.</div>
    <div class="bye-note" id="byeNote"></div>
  </div>

  <script>
    const done  = new Set();
    const TOTAL = 3;

    function acknowledge(card, e) {
      if (card.classList.contains('done')) return;

      // ripple
      const r   = card.getBoundingClientRect();
      const rpl = document.createElement('span');
      rpl.className = 'ripple';
      const s = Math.max(r.width, r.height);
      rpl.style.cssText = `width:${s}px;height:${s}px;left:${e.clientX-r.left-s/2}px;top:${e.clientY-r.top-s/2}px`;
      card.appendChild(rpl);
      setTimeout(() => rpl.remove(), 650);

      card.classList.add('done');
      done.add(card.dataset.id);

      // update step num label
      card.querySelector('.step-num').textContent = 'Rule 0' + (parseInt(card.dataset.id)+1) + ' ¬∑ ‚úì Confirmed';

      tick();
    }

    function tick() {
      const n = done.size;
      const fill = document.getElementById('progFill');
      fill.style.width = (n / TOTAL * 100) + '%';
      if (n === TOTAL) fill.classList.add('done');

      for (let i = 0; i < TOTAL; i++) {
        const dot = document.getElementById('ps' + i);
        if (i < n) {
          dot.classList.add('done-step');
          dot.classList.remove('active-step');
        } else if (i === n) {
          dot.classList.add('active-step');
        }
      }

      if (n === TOTAL) {
        document.getElementById('emergencyCard').classList.add('unlocked');
        document.getElementById('lockedHint').classList.add('hidden');
        setTimeout(() => {
          document.getElementById('emergencyCard').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 350);
      }
    }

    function openMail() {
      document.getElementById('mailModal').classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeMail() {
      document.getElementById('mailModal').classList.remove('open');
      document.body.style.overflow = '';
    }
    function doSend(e) {
      e.preventDefault();
      const name = document.getElementById('sName').value.trim();
      const sub  = document.getElementById('sSubject').value.trim() || 'Urgent Message';
      const body = document.getElementById('sBody').value.trim();
      const full = (name ? 'From: ' + name + '\n\n' : '') + (body || '(No message body)');
      window.location.href = 'mailto:furkan.khan@timesinternet.in?subject=' + encodeURIComponent(sub) + '&body=' + encodeURIComponent(full);
    }

    function openBye() {
      document.getElementById('byeOverlay').classList.add('open');
      document.body.style.overflow = 'hidden';
      setTimeout(() => {
        try { window.close(); } catch(err) {}
        document.getElementById('byeNote').textContent = 'You may close this tab now.';
      }, 2600);
    }

    document.getElementById('mailModal').addEventListener('click', function(e) {
      if (e.target === this) closeMail();
    });

    // mark first dot as active on load
    document.getElementById('ps0').classList.add('active-step');
  </script>

</body>
</html>
